<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Peta Wisata Pontianak (Manual Polygon)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    <style>
        html, body { height: 100%; margin: 0; }
        #map { height: 100vh; }
        .legend { background: white; padding: 8px; border-radius: 6px; font-size: 13px; box-shadow: 0 0 8px rgba(0,0,0,0.2); }
        .legend div { margin: 4px 0; }
        .swatch { display:inline-block; width:12px; height:12px; margin-right:6px; vertical-align:middle; }
    </style>
</head>
<body>
<div id="map"></div>

<script>
    // ===== Data koordinat wisata =====
    const wisata = [
      { id: "tugu", name: "Tugu Khatulistiwa", coords: [0.0011389748762005714, 109.32219446588596], color: "green" },
      { id: "museum", name: "Museum Ayani Pontianak", coords: [-0.04839169629164504, 109.34288705239467], color: "purple" },
      { id: "rumah", name: "Rumah Radang", coords: [-0.046627321340859555, 109.3200255118583], color: "brown" },
      { id: "masjid", name: "Masjid Raya Mujahidin", coords: [-0.0414143116164895, 109.33625065239468], color: "red" },
      { id: "alun", name: "Taman Alun Kapuas", coords: [-0.02148169804885702, 109.33935736953043], color: "orange" }
    ];

    // ===== Inisialisasi peta =====
    const map = L.map('map').setView([-0.02, 109.33], 13);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // ===== Tambah marker =====
    wisata.forEach(w => {
      L.marker(w.coords).addTo(map).bindPopup(`<b>${w.name}</b>`);
    });

    // ===== Polyline mengikuti jalan raya =====
    const coordsString = wisata.map(w => `${w.coords[1]},${w.coords[0]}`).join(';');
    const url = `https://router.project-osrm.org/route/v1/driving/${coordsString}?overview=full&geometries=geojson`;

    fetch(url)
      .then(res => res.json())
      .then(data => {
        if (data.routes && data.routes.length > 0) {
          const route = data.routes[0].geometry;
          const line = L.geoJSON(route, {
            style: { color: 'blue', weight: 4, opacity: 0.8 }
          }).addTo(map);
          map.fitBounds(line.getBounds());
        } else {
          alert('Rute tidak ditemukan!');
        }
      })
      .catch(err => console.error('Gagal memuat rute:', err));

    // ===== Polygon manual =====
    // kamu bisa isi koordinat sesuai hasil mapping kamu di sini ðŸ‘‡
    const polygonData = [
      {
        name: "Tugu Khatulistiwa",
        color: "green",
        coords: [
          [0.000979383442090758, 109.32193429160775],
          [0.0012771086368944078, 109.32211131740472],
          [0.0010705785468092864, 109.32246268678963],
          [0.0007674889340682951, 109.32230175424692]
        ]
      },
      {
        name: "Museum Ayani Pontianak",
        color: "purple",
        coords: [
          [-0.04867064592370316, 109.34221113571535],
          [-0.048091288994300437, 109.34272611985199],
          [-0.04854189993982117, 109.34313381562686],
          [-0.0492070875205737, 109.34256518730929]
        ]
      },
      {
        name: "Rumah Radang",
        color: "brown",
        coords: [
          [-0.04749635675161702, 109.31922084914477],
          [-0.04630545637116765, 109.32049758065024],
          [-0.04575828591936454, 109.31982166397088],
          [-0.04691699981230369, 109.31849128828452]
        ]
      },
      {
        name: "Masjid Raya Mujahidin",
        color: "red",
        coords: [
          [-0.041435769282590205, 109.33558546455147],
          [-0.040545276134856555, 109.33658324631624],
          [-0.04204731276381396, 109.33792435083878],
          [-0.043045094222840564, 109.33692656907401]
        ]
      },
      {
        name: "Taman Alun Kapuas",
        color: "orange",
        coords: [
          [-0.021546071062553008, 109.33903550443515],
          [-0.02104181581238317, 109.33940028486526],
          [-0.021578257567836167, 109.33988308249337],
          [-0.0219215802903307, 109.33951830206324],
        ]
      }
    ];

    // Tambahkan polygon ke peta
    polygonData.forEach(p => {
      L.polygon(p.coords, {
        color: p.color,
        fillColor: p.color,
        fillOpacity: 0.3
      }).addTo(map).bindPopup(`Area: ${p.name}`);
    });

    // ===== Legend =====
    const legend = L.control({ position: 'topright' });
    legend.onAdd = function() {
      const div = L.DomUtil.create('div', 'legend');
      div.innerHTML = `<b>Legenda Peta Wisata</b><br>
        <div><span class='swatch' style='background:blue'></span>Rute Wisata</div>
        <div><span class='swatch' style='background:green'></span>Tugu Khatulistiwa</div>
        <div><span class='swatch' style='background:purple'></span>Museum Ayani</div>
        <div><span class='swatch' style='background:brown'></span>Rumah Radang</div>
        <div><span class='swatch' style='background:red'></span>Masjid Raya Mujahidin</div>
        <div><span class='swatch' style='background:orange'></span>Taman Alun Kapuas</div>`;
      return div;
    };
    legend.addTo(map);
</script>
</body>
</html>
